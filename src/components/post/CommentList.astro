---
import fetchApi from "@lib/strapi";
import type Comment from "@interfaces/comment";
import type Article from "@interfaces/article";
import CommentComp from "./Comment.astro";

import "../../styles/comment.css";

type Props = {
  id: Article["id"];
};

const { id } = Astro.props;

const comment = await fetchApi<Comment[]>({
  endpoint: `/comments/api::article.article:${id}`,
});

console.log(comment);
---

<div>
  <h2 class="text-3xl">Comment</h2>
  <form class="commentForm">
    <div class="flex gap-2 w-full min-h-[150px] my-3">
      <div class="flex gap-2 flex-col min-w-[20rem]">
        <div class="inputDiv">
          <input type="text" name="nickname" id="nickname" placeholder="nickname" />
        </div>
        <div class="inputDiv">
          <input type="email" name="email" id="email" placeholder="example@example.com" />
        </div>
      </div>
      <div class="inputDiv min-h-[150px]">
        <textarea name="content" id="content" placeholder="comment input" class="w-full h-full"
        ></textarea>
      </div>
    </div>
    <button
      type="submit"
      class="rounded-full mr-0 m-auto bg-primaryColor text-secondaryColor px-8 py-4 block"
      >Send</button
    >
    <input type="hidden" name="postID" id="postID" value={id} />
  </form>
  <div class="my-4 gap-4 flex flex-col">
    {comment.map((c) => <CommentComp children={c} postID={id} />)}
  </div>
</div>
<script src="/post/comment_submit.js" is:inline></script>
